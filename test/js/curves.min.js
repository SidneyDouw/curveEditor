!function(t,i){"object"==typeof exports&&"object"==typeof module?module.exports=i():"function"==typeof define&&define.amd?define([],i):"object"==typeof exports?exports.Curve=i():t.Curve=i()}("undefined"!=typeof self?self:this,function(){return function(t){var i={};function s(o){if(i[o])return i[o].exports;var n=i[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,s),n.l=!0,n.exports}return s.m=t,s.c=i,s.d=function(t,i,o){s.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:o})},s.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(i,"a",i),i},s.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},s.p="",s(s.s=0)}([function(t,i,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=s(1);i.default=o.a},function(t,i,s){"use strict";var o=s(2);i.a=class{constructor(t,i,s){this.BezierPoint=o.a,this.cpDist=s||.2*t.canvas.width,this.pointColor="#f00",this.pointSize=4,this.lineColor="#fff",this.lineWidth=1,this.points=[new o.a(0,t.canvas.height,t,this.pointColor,this.pointSize,this.cpDist),new o.a(t.canvas.width,0,t,this.pointColor,this.pointSize,this.cpDist)],this.ctx=t,this.cw=t.canvas.width,this.ch=t.canvas.height,this.mouseX=0,this.mouseY=0,this.events={},this.interval=i,this.canvasEvents(),this.createLUT(),this.draw()}xGetY(t){let i=0,s=5e3,o=(i+s)/2,n=t/this.interval,p=this.lookupX[o],e=0;for(;Math.abs(n-p)>1e-4&&(e++,p>n?s=o:p<n&&(i=o),o=Math.round((i+s)/2),p=this.lookupX[o],!(e>20)););return this.lookupY[o]}createLUT(){this.lookupX=[],this.lookupY=[];for(let t=1;t<this.points.length;t++){let i=this.points[t-1],s=this.points[t],o=s.position.x/this.cw-i.position.x/this.cw;for(let t=0;t<1;t+=1/(5e3*o)){let o=Math.pow(1-t,3)*i.position.x+3*Math.pow(1-t,2)*t*i.cp2.x+3*(1-t)*Math.pow(t,2)*s.cp1.x+Math.pow(t,3)*s.position.x,n=Math.pow(1-t,3)*i.position.y+3*Math.pow(1-t,2)*t*i.cp2.y+3*(1-t)*Math.pow(t,2)*s.cp1.y+Math.pow(t,3)*s.position.y;this.lookupX.push(o/this.cw),this.lookupY.push(-n/this.ch+1)}}}on(t,i){this.events["on"+t]=i.bind(this)}canvasEvents(){let t,i,s,o,p,e,c=this;this.ctx.canvas.addEventListener("mousemove",function(h){let r=this.getBoundingClientRect();t=h.clientX-r.left,i=h.clientY-r.top,c.mouseX=t,c.mouseY=i;for(let n=0;n<c.points.length;n++){let h=c.points[n];if(!e){if((s=Math.sqrt((t-h.position.x)*(t-h.position.x)+(i-h.position.y)*(i-h.position.y)))<=c.pointSize/2+2){this.style.cursor="pointer",o=n;break}if((s=Math.sqrt((t-h.cp1.x)*(t-h.cp1.x)+(i-h.cp1.y)*(i-h.cp1.y)))<=c.pointSize/2+2){this.style.cursor="pointer",o=n,p="cp1";break}if((s=Math.sqrt((t-h.cp2.x)*(t-h.cp2.x)+(i-h.cp2.y)*(i-h.cp2.y)))<=c.pointSize/2+2){this.style.cursor="pointer",o=n,p="cp2";break}this.style.cursor="initial",o=!1,p=!1}}if(n[18]){let s=c.cw/20,o=c.ch/10,n=Math.floor((t+s/2)/s),p=Math.floor((i+o/2)/o);t=s*n,i=o*p}if(e){if("cp1"==p)c.points[o].cp1.x=t,c.points[o].cp1.y=i,c.points[o].move(),n[16]||(c.points[o].cp2.x=t-2*c.points[o].v1x,c.points[o].cp2.y=i-2*c.points[o].v1y);else if("cp2"==p)c.points[o].cp2.x=t,c.points[o].cp2.y=i,c.points[o].move(),n[16]||(c.points[o].cp1.x=t-2*c.points[o].v2x,c.points[o].cp1.y=i-2*c.points[o].v2y);else{let s;c.points[o].move(),c.points[o].position.x=t,c.points[o].position.y=i,0===o&&(c.points[o].position.x=0),o==c.points.length-1&&(c.points[o].position.x=c.cw),c.points[o].cp1.x=c.points[o].position.x+c.points[o].v1x,c.points[o].cp1.y=c.points[o].position.y+c.points[o].v1y,c.points[o].cp2.x=c.points[o].position.x+c.points[o].v2x,c.points[o].cp2.y=c.points[o].position.y+c.points[o].v2y,c.points[o-1]&&c.points[o+1]&&(c.points[o].position.x>c.points[o+1].position.x&&(s=c.points[o],c.points[o]=c.points[o+1],c.points[o+1]=s,o++),c.points[o-1].position.x>c.points[o].position.x&&(s=c.points[o],c.points[o]=c.points[o-1],c.points[o-1]=s,o--))}c.events.ondrag&&c.events.ondrag(),c.draw()}c.events.onmousemove&&c.events.onmousemove()}),this.ctx.canvas.addEventListener("mousedown",function(n){n.preventDefault(),o||0===o?e=!0:s>5&&(o=c.addPoint(t,i),e=!0,this.style.cursor="pointer",c.draw(),c.events.onnewpoint&&c.events.onnewpoint())}),this.ctx.canvas.addEventListener("mouseup",function(n){e=!1,s>5&&(o=p=!1);for(let n=0;n<c.points.length;n++){let p=c.points[n];if((s=Math.sqrt((t-p.position.x)*(t-p.position.x)+(i-p.position.y)*(i-p.position.y)))<=c.pointSize/2+2){this.style.cursor="pointer",o=n;break}}c.createLUT()}),this.ctx.canvas.addEventListener("mouseleave",function(s){e&&(s.offsetX<0||s.offsetX>c.cw?s.offsetX<0?"cp1"==p?(c.points[o].cp1.x=0,c.points[o].move(),n[16]||(c.points[o].cp2.x=0-2*c.points[o].v1x,c.points[o].cp2.y=i-2*c.points[o].v1y)):"cp2"==p?(c.points[o].cp2.x=0,c.points[o].move(),n[16]||(c.points[o].cp1.x=0-2*c.points[o].v2x,c.points[o].cp1.y=i-2*c.points[o].v2y)):(c.points[o].position.x=0,c.points[o].cp1.x=0+c.points[o].v1x,c.points[o].cp2.x=0+c.points[o].v2x):"cp1"==p?(c.points[o].cp1.x=c.cw,c.points[o].move(),n[16]||(c.points[o].cp2.x=c.cw-2*c.points[o].v1x,c.points[o].cp2.y=i-2*c.points[o].v1y)):"cp2"==p?(c.points[o].cp2.x=c.cw,c.points[o].move(),n[16]||(c.points[o].cp1.x=c.cw-2*c.points[o].v2x,c.points[o].cp1.y=i-2*c.points[o].v2y)):(c.points[o].position.x=c.cw,c.points[o].cp1.x=c.cw+c.points[o].v1x,c.points[o].cp2.x=c.cw+c.points[o].v2x):(s.offsetY<0||s.offsetY>c.ch)&&(s.offsetY<0?"cp1"==p?(c.points[o].cp1.y=0,c.points[o].move(),n[16]||(c.points[o].cp2.x=t-2*c.points[o].v1x,c.points[o].cp2.y=0-2*c.points[o].v1y)):"cp2"==p?(c.points[o].cp2.y=0,c.points[o].move(),n[16]||(c.points[o].cp1.x=t-2*c.points[o].v2x,c.points[o].cp1.y=0-2*c.points[o].v2y)):(c.points[o].position.y=0,c.points[o].cp1.y=0+c.points[o].v1y,c.points[o].cp2.y=0+c.points[o].v2y):"cp1"==p?(c.points[o].cp1.y=c.ch,c.points[o].move(),n[16]||(c.points[o].cp2.x=t-2*c.points[o].v1x,c.points[o].cp2.y=c.ch-2*c.points[o].v1y)):"cp2"==p?(c.points[o].cp2.y=c.ch,c.points[o].move(),n[16]||(c.points[o].cp1.x=t-2*c.points[o].v2x,c.points[o].cp1.y=c.ch-2*c.points[o].v2y)):(c.points[o].position.y=c.ch,c.points[o].cp1.y=c.ch+c.points[o].v1y,c.points[o].cp2.y=c.ch+c.points[o].v2y))),c.draw(),c.createLUT(),e=o=p=!1}),this.ctx.canvas.addEventListener("click",function(t){n[16]&&!p&&(c.points[o].collapse(),c.draw(),c.createLUT(),c.events.ontogglecontrol&&c.events.ontogglecontrol())}),this.ctx.canvas.addEventListener("dblclick",function(t){c.points.splice(o,1),e=o=p=!1,s=1e3,this.style.cursor="initial",c.draw(),c.createLUT(),c.events.onremovepoint&&c.events.onremovepoint()})}addPoint(t,i){this.points.push(new o.a(t,i,this.ctx,this.pointColor,this.pointSize,this.cpDist)),this.points.sort(function(t,i){return t.position.x-i.position.x});for(let s=0;s<this.points.length;s++){let o=this.points[s];if(t==o.position.x&&i==o.position.y)return s}}setPointStyle(t,i){for(let s=0;s<this.points.length;s++)this.points[s].setPointStyle(t,i),this.pointColor=t,this.pointSize=i;this.draw()}setLineStyle(t,i){this.lineColor=t,this.lineWidth=i,this.draw()}draw(){this.ctx.clearRect(0,0,this.cw,this.ch),this.ctx.strokeStyle="#444",this.ctx.lineWidth=1;for(let t=1;t<10;t++)this.ctx.beginPath(),this.ctx.moveTo(this.cw/10*t-.5,0),this.ctx.lineTo(this.cw/10*t-.5,this.ch),this.ctx.stroke();for(let t=1;t<5;t++)this.ctx.beginPath(),this.ctx.moveTo(0,this.ch/5*t-.5),this.ctx.lineTo(this.cw,this.ch/5*t-.5),this.ctx.stroke();this.ctx.lineWidth=.5;for(let t=1;t<20;t++)this.ctx.beginPath(),this.ctx.moveTo(this.cw/20*t-.5,0),this.ctx.lineTo(this.cw/20*t-.5,this.ch),this.ctx.stroke();for(let t=1;t<10;t++)this.ctx.beginPath(),this.ctx.moveTo(0,this.ch/10*t-.5),this.ctx.lineTo(this.cw,this.ch/10*t-.5),this.ctx.stroke();this.ctx.strokeStyle=this.lineColor,this.ctx.lineWidth=this.lineWidth,this.ctx.beginPath(),this.ctx.moveTo(this.points[0].position.x,this.points[0].position.y);for(let t=1;t<this.points.length;t++){let i=this.points[t],s=this.points[t-1];this.ctx.bezierCurveTo(s.cp2.x,s.cp2.y,i.cp1.x,i.cp1.y,i.position.x,i.position.y)}this.ctx.stroke();for(let t=0;t<this.points.length;t++)this.points[t].draw()}};const n=[];window.addEventListener("keydown",function(t){n[t.keyCode]=!0}),window.addEventListener("keyup",function(t){delete n[t.keyCode]})},function(t,i,s){"use strict";var o=s(3);i.a=class{constructor(t,i,s,n,p,e){this.cpDist=e,this.color=n,this.size=p,this.position=new o.a(t,i,this.color,this.size,s),this.cp1=new o.a(t-this.cpDist,i,this.color,this.size,s),this.cp2=new o.a(t+this.cpDist,i,this.color,this.size,s),this.ctx=s,this.r=2,this.collapsed=!1}collapse(){this.collapsed?(this.collapsed=!1,this.cp1.x=this.position.x-this.cpDist,this.cp2.x=this.position.x+this.cpDist):(this.collapsed=!0,this.cp1.x=this.cp2.x=this.position.x,this.cp1.y=this.cp2.y=this.position.y)}move(){this.collapsed?this.v1x=this.v1y=this.v2x=this.v2y=0:(this.v1x=this.cp1.x-this.position.x,this.v1y=this.cp1.y-this.position.y,this.v2x=this.cp2.x-this.position.x,this.v2y=this.cp2.y-this.position.y)}setPointStyle(t,i){this.position.color=t,this.cp1.color=t,this.cp2.color=t,this.position.r=i/2,this.cp1.r=i/2,this.cp2.r=i/2}draw(){this.ctx.lineWidth=.2,this.ctx.beginPath(),this.ctx.moveTo(this.position.x,this.position.y),this.ctx.lineTo(this.cp1.x,this.cp1.y),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(this.position.x,this.position.y),this.ctx.lineTo(this.cp2.x,this.cp2.y),this.ctx.stroke(),this.position.draw(),this.cp1.draw(),this.cp2.draw()}}},function(t,i,s){"use strict";i.a=class{constructor(t,i,s,o,n){this.x=t,this.y=i,this.r=o/2,this.color=s,this.ctx=n}draw(){this.ctx.fillStyle=this.color,this.ctx.beginPath(),this.ctx.arc(this.x,this.y,this.r,0,2*Math.PI,!1),this.ctx.closePath(),this.ctx.fill()}}}]).default});
//# sourceMappingURL=curves.min.js.map